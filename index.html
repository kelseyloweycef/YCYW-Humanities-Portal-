<script type="text/babel" data-type="module">
    // ... (Keep previous Firebase and AI imports)

    const Dashboard = ({ userData, resources }) => {
        const [followedSubjects, setFollowedSubjects] = useState(userData.followedSubjects || userData.subjects);
        
        // Dynamic Greeting
        const hour = new Date().getHours();
        const greeting = hour < 12 ? "Good Morning" : hour < 18 ? "Good Afternoon" : "Good Evening";

        // Filtering Updates based on followed subjects
        const recentUpdates = resources
            .filter(r => followedSubjects.includes(r.subject))
            .slice(0, 5);

        return (
            <div className="space-y-8 animate-in">
                {/* Hero Welcome */}
                <div className="relative overflow-hidden rounded-[3rem] p-10 text-white shadow-2xl bg-gradient-to-br from-indigo-600 via-slate-800 to-slate-900">
                    <div className="relative z-10">
                        <h1 className="text-4xl font-black tracking-tight mb-2">{greeting}, {userData.name.split(' ')[0]}!</h1>
                        <p className="text-indigo-200 font-medium max-w-md">Welcome back to the YCYW Humanities hub. Here is what is happening in your departments today.</p>
                    </div>
                    {/* Decorative Mesh Circle */}
                    <div className="absolute top-[-20%] right-[-10%] w-80 h-80 bg-indigo-500 rounded-full blur-[100px] opacity-50"></div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    {/* Column 1 & 2: Main Feed */}
                    <div className="lg:col-span-2 space-y-8">
                        
                        {/* Humanities Foundation Feed */}
                        <section className="bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-sm">
                            <div className="flex items-center justify-between mb-6">
                                <h3 className="text-xl font-black text-slate-800 uppercase tracking-tighter">Foundation Feed</h3>
                                <span className="bg-emerald-100 text-emerald-600 text-[10px] font-black px-3 py-1 rounded-full uppercase">Live Notices</span>
                            </div>
                            <div className="space-y-4">
                                <div className="p-4 bg-slate-50 rounded-2xl border-l-4 border-indigo-500">
                                    <p className="text-sm font-bold text-slate-800">Celebration: IGCSE Geography Results</p>
                                    <p className="text-xs text-slate-500 mt-1">Huge congratulations to the Shanghai team for the record-breaking 98% A*-C rate!</p>
                                </div>
                                <div className="p-4 bg-slate-50 rounded-2xl">
                                    <p className="text-sm font-bold text-slate-800">New Philosophy Scheme of Work</p>
                                    <p className="text-xs text-slate-500 mt-1">The Year 9 "Ethics in AI" module is now live and ready for use.</p>
                                </div>
                            </div>
                        </section>

                        {/* Recent Updates (Followed Subjects) */}
                        <section>
                            <div className="flex items-center justify-between mb-4 px-2">
                                <h3 className="text-lg font-black text-slate-800 uppercase tracking-tighter">Resources For You</h3>
                                <button className="text-[10px] font-black text-indigo-600 uppercase border-b-2 border-indigo-600">Edit Preferences</button>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {recentUpdates.length > 0 ? recentUpdates.map(res => (
                                    <div key={res.id} className="bg-white p-6 rounded-3xl border border-slate-100 hover:shadow-lg transition-all">
                                        <span className="text-[9px] font-black text-indigo-500 uppercase">{res.subject}</span>
                                        <h4 className="font-bold text-slate-800 mt-1">{res.title}</h4>
                                        <p className="text-[10px] text-slate-400 mt-2 font-bold uppercase">Added by {res.author}</p>
                                    </div>
                                )) : (
                                    <div className="col-span-2 py-10 text-center bg-slate-100 rounded-3xl border-2 border-dashed">
                                        <p className="text-xs font-bold text-slate-400">FOLLOW SUBJECTS TO SEE UPDATES</p>
                                    </div>
                                )}
                            </div>
                        </section>
                    </div>

                    {/* Column 3: Sidebar Info */}
                    <div className="space-y-8">
                        {/* Upcoming Events / PD */}
                        <section className="bg-indigo-50 rounded-[2.5rem] p-8 border border-indigo-100">
                            <h3 className="text-lg font-black text-indigo-900 uppercase tracking-tighter mb-6">Upcoming PD</h3>
                            <div className="space-y-6">
                                <div className="flex gap-4">
                                    <div className="bg-white w-12 h-12 rounded-2xl flex flex-col items-center justify-center shadow-sm shrink-0">
                                        <span className="text-[10px] font-black text-indigo-600 uppercase">Jan</span>
                                        <span className="text-lg font-black text-slate-800 leading-none">15</span>
                                    </div>
                                    <div>
                                        <p className="text-sm font-bold text-slate-800">IB Workshop</p>
                                        <p className="text-[10px] text-slate-500 font-medium">Internal Assessment Moderation</p>
                                    </div>
                                </div>
                                <div className="flex gap-4 opacity-60">
                                    <div className="bg-white w-12 h-12 rounded-2xl flex flex-col items-center justify-center shadow-sm shrink-0">
                                        <span className="text-[10px] font-black text-indigo-600 uppercase">Feb</span>
                                        <span className="text-lg font-black text-slate-800 leading-none">02</span>
                                    </div>
                                    <div>
                                        <p className="text-sm font-bold text-slate-800">Global Humanities Cafe</p>
                                        <p className="text-[10px] text-slate-500 font-medium">Topic: Decolonizing the Curriculum</p>
                                    </div>
                                </div>
                            </div>
                            <button className="w-full mt-8 py-3 bg-white rounded-2xl text-[10px] font-black text-indigo-600 uppercase shadow-sm">View Calendar</button>
                        </section>
                    </div>
                </div>
            </div>
        );
    };
</script>
